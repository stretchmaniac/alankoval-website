function parseLatex(a,b){function D(a,b){return"("+b+")"}variables=[thetaChar,phiChar,rhoChar,"e","pi","x","y","z","r","u","v"];for(var c=0;c<b.length;c++)variables.push(b[c].name);a=a.replace(/\\theta/g," "+thetaChar),a=a.replace(/\\phi/g," "+phiChar),a=a.replace(/\\rho/g," "+rhoChar),a=a.replace(/\\pi/g," pi"),a=a.replace(/\\left\(/g,"{"),a=a.replace(/\\right\)/g,"}"),a=a.replace(/\)/g,"}"),a=a.replace(/\(/g,"{"),a=a.replace(/\\left/g,""),a=a.replace(/\\right/g,"");var d,e;for(e=/operatorname{/g;null!==(d=/operatorname{/g.exec(a));){var f=d.index,g=f+13,h=matchingRightChar("{","}",a,g),i=a.substring(g,h);a=a.substring(0,f)+i+" "+a.substring(h+1,a.length)}for(e=/text{/g;null!==(d=e.exec(a));)f=d.index,g=f+5,h=matchingRightChar("{","}",a,g),i=a.substring(g,h),a=a.substring(0,f)+i+" "+a.substring(h+1,a.length);for(var j=0;j<variables.length;j++){for(var k=variables[j],l=new RegExp(k,"g"),m=[];null!==(d=l.exec(a));){f=d.index;for(var n=!0,o=f;o>=0;o--){var p=a.charAt(o);if(p.match(/\\/)){n=!1;break}if(p.match(/[^a-zA-Z]/)){n=!0;break}}n&&m.push(f)}for(var q=m.length-1;q>=0;q--){var r=m[q];a=a.substring(0,r)+"@"+k+"?"+a.substring(r+k.length,a.length)}}a=a.replace(new RegExp("("+thetaChar+")","g"),"(theta)"),a=a.replace(new RegExp("("+phiChar+")","g"),"(phi)"),a=a.replace(new RegExp("("+rhoChar+")","g"),"(rho)"),a=a.replace(/\\cdot/g,"*"),a=a.replace(/ /g,"");var s;for(s=/\|/g;null!==(d=s.exec(a));){f=d.index;for(var t=a.length-1;t>f;t--)if("|"===a.charAt(t)){var i=a.substring(f+1,t);a=a.substring(0,f)+"abs{"+i+"}"+a.substring(t+1,a.length);break}}for(var u in singleArgFuncs)for(s=new RegExp(u,"g");null!==(d=s.exec(a));){var f=d.index,v=f+u.length-1;if("{"===a.charAt(v))h=matchingRightChar("{","}",a,v),a=a.substring(0,f)+singleArgFuncs[u]+a.substring(v,a.length);else{for(var w=!0,x=v;w;){var p=a.charAt(x);"{"===p?(x=matchingRightChar("{","}",a,x)+1,w=!0):"["===p?x=matchingRightChar("[","]",a,x)+1:"+"===p||"-"===p||"}"===p||x===a.length?(x--,w=!1):(w=!0,x++)}var h=x;a=a.substring(0,f)+singleArgFuncs[u]+"{"+a.substring(v,h+1)+"}"+a.substring(h+1,a.length)}}for(s=/\\frac/g;null!==(d=s.exec(a));){var f=d.index+5,h=matchingRightChar("{","}",a,f),z=h+1,A=matchingRightChar("{","}",a,z),B=a.substring(f,h+1),C=a.substring(z,A+1);a="{"+a.substring(0,d.index)+B+"/"+C+a.substring(A+1,a.length)+"}"}for(;a.match(/{([^\{\}]*)}/g);)a=a.replace(/{([^\{\}]*)}/g,D);return a=a.replace(/@/g,"("),a=a.replace(/\?/g,")"),a=a.replace(/\\/g,"")}function matchingRightChar(a,b,c,d){d++;for(var e=1;e>=1&&d<c.length;)c.charAt(d)===b?e--:c.charAt(d)===a&&e++,d++;return d-1}function matchingLeftChar(a,b,c,d){d--;for(var e=1;e>=1&&d>=0;)c.charAt(d)===a?e++:c.charAt(d)===b&&e--,d--;return d+1}function getNextChunk(a,b,c){if("{"===a.charAt(b+1)){var d=matchingBrace(a,b+1);return a.substring(b+1,d+1)}if("pow"===c)return a.charAt(b+1)}function getPreviousChunk(a,b,c){if("}"===a.charAt(b-1)){for(var d=matchingBraceLeft(a,b-1),e=0;e<singleArgFuncs.length;e++){var f=singleArgFuncs[e];a.substring(d-f.length,d)===f&&(d-=f.length)}return a.substring(d,b)}if("pow"===c){for(var g=a.charAt(b-1)+"",h=b-1,e=0;e<variables.length;e++)if(g===variables[e])return g;for(;a.charAt(h).match(/\d/);)h--;return a.substring(h+1,b)}}var singleArgFuncs={"\\\\sinh":"sinh","\\\\sin":"sin","\\\\cosh":"cosh","\\\\cos":"cos","\\\\tanh":"tanh","\\\\tan":"tan","\\\\atanh":"atanh","\\\\atan2":"atan2","\\\\atan":"atan","\\\\asinh":"asinh","\\\\asin":"asin","\\\\acosh":"acosh","\\\\acos":"acos","\\\\ln":"log","\\\\sqrt":"sqrt","\\\\min":"min","\\\\max":"max","\\\\log":"log","\\\\csch":"csch","\\\\csc":"csc","\\\\sech":"sech","\\\\sec":"sec","\\\\stirlingS2":"stirlingS2"},thetaChar="Ì",phiChar="É",rhoChar="Î",variables=[thetaChar,phiChar,rhoChar,"e","pi","x","y","z","r","u","v"];